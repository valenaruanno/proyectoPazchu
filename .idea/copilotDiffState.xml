<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/englishteacher-api/src/main/java/com/englishproject/englishteacherapi/config/SecurityConfig.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/englishteacher-api/src/main/java/com/englishproject/englishteacherapi/config/SecurityConfig.java" />
              <option name="originalContent" value="package com.englishproject.englishteacherapi.config;&#10;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.security.config.annotation.web.builders.HttpSecurity;&#10;import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;&#10;import org.springframework.security.web.SecurityFilterChain;&#10;import org.springframework.web.cors.CorsConfiguration;&#10;import org.springframework.web.cors.CorsConfigurationSource;&#10;import org.springframework.web.cors.UrlBasedCorsConfigurationSource;&#10;import java.util.Arrays;&#10;&#10;@Configuration&#10;@EnableWebSecurity&#10;public class SecurityConfig {&#10;&#10;    @Bean&#10;    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {&#10;        http&#10;            .cors(cors -&gt; cors.configurationSource(corsConfigurationSource()))&#10;            .csrf(csrf -&gt; csrf.disable())&#10;            .authorizeHttpRequests(authz -&gt; authz&#10;                .requestMatchers(&quot;/api/**&quot;).permitAll()&#10;                .requestMatchers(&quot;/h2-console/**&quot;).permitAll()&#10;                .anyRequest().authenticated()&#10;            )&#10;            .headers(headers -&gt; headers.frameOptions(frameOptions -&gt; frameOptions.sameOrigin())); // For H2 console&#10;&#10;        return http.build();&#10;    }&#10;&#10;    @Bean&#10;    public CorsConfigurationSource corsConfigurationSource() {&#10;        CorsConfiguration configuration = new CorsConfiguration();&#10;        configuration.setAllowedOriginPatterns(Arrays.asList(&quot;http://localhost:*&quot;));&#10;        configuration.setAllowedMethods(Arrays.asList(&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, &quot;OPTIONS&quot;));&#10;        configuration.setAllowedHeaders(Arrays.asList(&quot;*&quot;));&#10;        configuration.setAllowCredentials(true);&#10;&#10;        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();&#10;        source.registerCorsConfiguration(&quot;/**&quot;, configuration);&#10;        return source;&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.englishproject.englishteacherapi.config;&#10;&#10;import org.springframework.context.annotation.Bean;&#10;import org.springframework.context.annotation.Configuration;&#10;import org.springframework.security.config.annotation.web.builders.HttpSecurity;&#10;import org.springframework.security.config.annotation.web.configuration.EnableWebSecurity;&#10;import org.springframework.security.web.SecurityFilterChain;&#10;import org.springframework.web.cors.CorsConfiguration;&#10;import org.springframework.web.cors.CorsConfigurationSource;&#10;import org.springframework.web.cors.UrlBasedCorsConfigurationSource;&#10;import java.util.Arrays;&#10;&#10;@Configuration&#10;@EnableWebSecurity&#10;public class SecurityConfig {&#10;&#10;    @Bean&#10;    public SecurityFilterChain filterChain(HttpSecurity http) throws Exception {&#10;        http&#10;            .cors(cors -&gt; cors.configurationSource(corsConfigurationSource()))&#10;            .csrf(csrf -&gt; csrf.disable())&#10;            .authorizeHttpRequests(authz -&gt; authz&#10;                .requestMatchers(&quot;/api/**&quot;).permitAll()&#10;                .requestMatchers(&quot;/h2-console/**&quot;).permitAll()&#10;                .anyRequest().authenticated()&#10;            )&#10;            .headers(headers -&gt; headers.frameOptions(frameOptions -&gt; frameOptions.sameOrigin())); // For H2 console&#10;&#10;        return http.build();&#10;    }&#10;&#10;    @Bean&#10;    public CorsConfigurationSource corsConfigurationSource() {&#10;        CorsConfiguration configuration = new CorsConfiguration();&#10;        configuration.setAllowedOriginPatterns(Arrays.asList(&quot;http://localhost:*&quot;));&#10;        configuration.setAllowedMethods(Arrays.asList(&quot;GET&quot;, &quot;POST&quot;, &quot;PUT&quot;, &quot;DELETE&quot;, &quot;OPTIONS&quot;));&#10;        configuration.setAllowedHeaders(Arrays.asList(&quot;*&quot;));&#10;        configuration.setAllowCredentials(true);&#10;&#10;        UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();&#10;        source.registerCorsConfiguration(&quot;/**&quot;, configuration);&#10;        return source;&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/englishteacher-api/src/main/java/com/englishproject/englishteacherapi/service/LevelService.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/englishteacher-api/src/main/java/com/englishproject/englishteacherapi/service/LevelService.java" />
              <option name="originalContent" value="package com.englishproject.englishteacherapi.service;&#10;&#10;import com.englishproject.englishteacherapi.dto.LevelDTO;&#10;import com.englishproject.englishteacherapi.model.Level;&#10;import com.englishproject.englishteacherapi.repository.LevelRepository;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.stereotype.Service;&#10;import java.util.List;&#10;import java.util.Optional;&#10;import java.util.stream.Collectors;&#10;&#10;@Service&#10;public class LevelService {&#10;&#10;    @Autowired&#10;    private LevelRepository levelRepository;&#10;&#10;    public List&lt;LevelDTO&gt; getAllLevels() {&#10;        return levelRepository.findAll().stream()&#10;                .map(this::convertToDTO)&#10;                .collect(Collectors.toList());&#10;    }&#10;&#10;    public Optional&lt;LevelDTO&gt; getLevelById(Long id) {&#10;        return levelRepository.findById(id)&#10;                .map(this::convertToDTO);&#10;    }&#10;&#10;    public Optional&lt;LevelDTO&gt; getLevelByName(String name) {&#10;        return levelRepository.findByName(name)&#10;                .map(this::convertToDTO);&#10;    }&#10;&#10;    public LevelDTO createLevel(LevelDTO levelDTO) {&#10;        Level level = convertToEntity(levelDTO);&#10;        Level savedLevel = levelRepository.save(level);&#10;        return convertToDTO(savedLevel);&#10;    }&#10;&#10;    public Optional&lt;LevelDTO&gt; updateLevel(Long id, LevelDTO levelDTO) {&#10;        return levelRepository.findById(id)&#10;                .map(level -&gt; {&#10;                    updateLevelFromDTO(level, levelDTO);&#10;                    Level savedLevel = levelRepository.save(level);&#10;                    return convertToDTO(savedLevel);&#10;                });&#10;    }&#10;&#10;    public boolean deleteLevel(Long id) {&#10;        if (levelRepository.existsById(id)) {&#10;            levelRepository.deleteById(id);&#10;            return true;&#10;        }&#10;        return false;&#10;    }&#10;&#10;    private LevelDTO convertToDTO(Level level) {&#10;        Long activitiesCount = level.getActivities() != null ?&#10;            level.getActivities().stream()&#10;                .filter(activity -&gt; activity.getIsActive())&#10;                .count() : 0L;&#10;&#10;        return new LevelDTO(&#10;                level.getId(),&#10;                level.getName(),&#10;                level.getDescription(),&#10;                activitiesCount&#10;        );&#10;    }&#10;&#10;    private Level convertToEntity(LevelDTO levelDTO) {&#10;        Level level = new Level();&#10;        updateLevelFromDTO(level, levelDTO);&#10;        return level;&#10;    }&#10;&#10;    private void updateLevelFromDTO(Level level, LevelDTO levelDTO) {&#10;        level.setName(levelDTO.getName());&#10;        level.setDescription(levelDTO.getDescription());&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.englishproject.englishteacherapi.service;&#10;&#10;import com.englishproject.englishteacherapi.dto.LevelDTO;&#10;import com.englishproject.englishteacherapi.model.Level;&#10;import com.englishproject.englishteacherapi.repository.LevelRepository;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.stereotype.Service;&#10;import java.util.List;&#10;import java.util.Optional;&#10;import java.util.stream.Collectors;&#10;&#10;@Service&#10;public class LevelService {&#10;&#10;    @Autowired&#10;    private LevelRepository levelRepository;&#10;&#10;    public List&lt;LevelDTO&gt; getAllLevels() {&#10;        return levelRepository.findAll().stream()&#10;                .map(this::convertToDTO)&#10;                .collect(Collectors.toList());&#10;    }&#10;&#10;    public Optional&lt;LevelDTO&gt; getLevelById(Long id) {&#10;        return levelRepository.findById(id)&#10;                .map(this::convertToDTO);&#10;    }&#10;&#10;    public Optional&lt;LevelDTO&gt; getLevelByName(String name) {&#10;        return levelRepository.findByName(name)&#10;                .map(this::convertToDTO);&#10;    }&#10;&#10;    public LevelDTO createLevel(LevelDTO levelDTO) {&#10;        Level level = convertToEntity(levelDTO);&#10;        Level savedLevel = levelRepository.save(level);&#10;        return convertToDTO(savedLevel);&#10;    }&#10;&#10;    public Optional&lt;LevelDTO&gt; updateLevel(Long id, LevelDTO levelDTO) {&#10;        return levelRepository.findById(id)&#10;                .map(level -&gt; {&#10;                    updateLevelFromDTO(level, levelDTO);&#10;                    Level savedLevel = levelRepository.save(level);&#10;                    return convertToDTO(savedLevel);&#10;                });&#10;    }&#10;&#10;    public boolean deleteLevel(Long id) {&#10;        if (levelRepository.existsById(id)) {&#10;            levelRepository.deleteById(id);&#10;            return true;&#10;        }&#10;        return false;&#10;    }&#10;&#10;    private LevelDTO convertToDTO(Level level) {&#10;        Long activitiesCount = level.getActivities() != null ?&#10;            level.getActivities().stream()&#10;                .filter(activity -&gt; activity.getIsActive())&#10;                .count() : 0L;&#10;&#10;        return new LevelDTO(&#10;                level.getId(),&#10;                level.getName(),&#10;                level.getDescription(),&#10;                activitiesCount&#10;        );&#10;    }&#10;&#10;    private Level convertToEntity(LevelDTO levelDTO) {&#10;        Level level = new Level();&#10;        updateLevelFromDTO(level, levelDTO);&#10;        return level;&#10;    }&#10;&#10;    private void updateLevelFromDTO(Level level, LevelDTO levelDTO) {&#10;        level.setName(levelDTO.getName());&#10;        level.setDescription(levelDTO.getDescription());&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>